{% extends "customers/base_generic.html" %}

{% block title %} Customer List {% endblock title %}

{% block content %}
	{% if customer_list %}
	<p>There {{customer_list.count|pluralize:"is,are"}} totally <b> {{ customer_list.count }} </b>customer{{customer_list.count|pluralize }}.</p>
	
	<input type="text" id="search-name" onkeyup="searchName()" placeholder="Search by name">
	</input>
	
	<table id="customer-table" class="table table-hover">
		<thead id="customer-table-header" class="thead-dark">
			<tr>
				<th>#</th>
				<th>Name</th>
				<th>Account</th>
				<th>Information</th>
				<th>Remarks</th>
				<!--<th>Info Created</th>
				<th>Info Updated</th> -->
				<th>View</th>
				{% if perms.customers.can_manage_customers %}
				<th>Edit</th>
				<th>Delete</th>
				{% endif %}
			</tr>
		</thead>
		<tbody>
			{% for customer in customer_list %}
				<tr>
					<td>{{ forloop.counter }}</td>
					<td>{{ customer.name }}</td>
					<td>{{ customer.account }}</td>
					<td>{{ customer.information }}</td>
					<td>{{ customer.remarks }}</td>
					<!-- <td><span class="badge">{{ customer.info_created_at }}</span></td>
					<td><span class="badge">{{ customer.info_updated_at }}</span></td> -->
					<td>
						<a href="{% url 'customers:customer-detail' customer.id %}" class="btn btn-sm btn-outline-primary"><i class="fa fa-eye"></i> View</a>
					</td>
					{% if perms.customers.can_manage_customers %}
					<td>
						<a href="{% url 'customers:customer-update' customer.id %}" class="btn btn-sm btn-outline-warning"><i class="fa fa-0.5x fa-edit"></i> Edit</a>
					</td>
					<td>
						<a href="{% url 'customers:customer-delete' customer.id %}" class="btn btn-sm btn-outline-danger"><i class="fa fa-trash"></i> Delete</a>
					</td>
					{% endif %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
	{% else %}
		<p class="text-danger">There is no customer right now.</p>
	{% endif %}

{% endblock content %}

{% block javascript %}
<script>
	function searchName() {
		var input, filter, table, tr, td, i, txtValue;
		input = document.getElementById("search-name");
		filter = input.value.toUpperCase();
		table = document.getElementById("customer-table");
		tr = table.getElementsByTagName("tr");

		for (i = 0; i < tr.length; i++){
			td = tr[i].getElementsByTagName('td')[1];
			if (td) {
				txtValue = td.textContent || td.innerText;
				if (txtValue.toUpperCase().indexOf(filter) > -1) {
					tr[i].style.display = "";
				} else {
					tr[i].style.display = "none";
				}
			}
		}
	}
</script>
{% endblock javascript %}